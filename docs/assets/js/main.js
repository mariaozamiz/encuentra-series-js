"use strict";let results=[],favs=[];const searchButton=document.querySelector(".js-search-form__button");function inputHandler(e){e.preventDefault();GetDataFromApi(document.querySelector(".js-search-form__input").value)}function GetDataFromApi(e){fetch("https://api.tvmaze.com/search/shows?q="+e).then((function(e){return e.json()})).then((function(e){results=e,paintResults()}))}function createCard(e,t){const n=document.createElement("li");return e.appendChild(n),n.setAttribute("id",t.show.id),addImage(n,t),addTitle(n,t),n}function addImage(e,t){const n=document.createElement("img");e.appendChild(n),t.show.image?n.src=t.show.image.medium.replace("http:","https:"):n.src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV"}function addTitle(e,t){const n=document.createElement("h3");e.appendChild(n),n.innerHTML=t.show.name}function paintFavs(){const e=document.querySelector(".js-favs-list");e.innerHTML="";const t=JSON.parse(localStorage.getItem("favShows"));if(t){favs=t;for(let n=0;n<t.length;n++){addDeleteIcon(createCard(e,t[n]))}addSectionTitle("favs",favs),addDeleteAllButton()}}function addDeleteIcon(e){const t=document.createElement("i");t.setAttribute("class","fa fa-times-circle fa-2x js-delete-icon"),e.appendChild(t),t.addEventListener("click",handleDeleteIconClick)}function addDeleteAllButton(){const e=document.querySelector(".js-favs-list__delete-button");e.addEventListener("click",deleteAllFavs),0===favs.length?e.classList.add("hidden"):e.classList.remove("hidden")}function paintResults(){const e=document.querySelector(".js-results-list");e.innerHTML="";for(const t of results){let n=createCard(e,t);addHighlightIfNeeded(n),n.addEventListener("click",handleCardClick)}addSectionTitle("results",results)}function addHighlightIfNeeded(e){findMatch(parseInt(e.id),favs)&&e.classList.add("yellow-background")}function addSectionTitle(e,t){const n=document.querySelector(`.${e}-list__title`);t.length>0?n.classList.remove("hidden"):n.classList.add("hidden")}function handleCardClick(e){const t=parseInt(e.currentTarget.id);findMatch(t,favs)?deleteAsFav(t):saveAsFav(t)}function findMatch(e,t){return t.find(t=>t.show.id===e)}function saveAsFav(e){const t=findMatch(e,results);favs.push(t),updateLocalStorage(),paintFavs(),paintResults()}function updateLocalStorage(){localStorage.setItem("favShows",JSON.stringify(favs))}function handleDeleteIconClick(e){deleteAsFav(parseInt(e.currentTarget.parentElement.id))}function deleteAsFav(e){const t=favs.findIndex(t=>t.show.id===e);favs.splice(t,1),updateLocalStorage(),paintFavs(),paintResults()}function deleteAllFavs(e){e.preventDefault(),favs=[],updateLocalStorage(),paintFavs(),paintResults()}searchButton.addEventListener("click",inputHandler),paintFavs();